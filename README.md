# Ladder and Laguerre Orthogonal Recurrent Neural Networks

> **Disclaimer:** this repository is no longer maintained. For an up-to-date version, please check [https://github.com/sergio-dorado/LaguerreRNNs](https://github.com/sergio-dorado/LaguerreRNNs)

**Authors:** Sergio A. Dorado-Rojas (sergio.dorado.rojas@gmail.com), Bhanu Vinzamuri (bhanu.vinzamuri@ibm.com), Luigi Vanfretti (luigi.vanfretti@gmail.com)

## Running an Experiment

Three different experiment setups are contained in this repo. Each can be run from the command line. All experiments can be run using the following architectures: [LSTM](https://www.oreilly.com/library/view/neural-networks-and/9781492037354/ch04.html), [GRU](https://www.oreilly.com/library/view/neural-networks-and/9781492037354/ch04.html), [nBRC](https://arxiv.org/pdf/2006.05252), [BRC](https://arxiv.org/pdf/2006.05252), [LMU](https://papers.nips.cc/paper/9689-legendre-memory-units-continuous-time-representation-in-recurrent-neural-networks.pdf), Ladder and Laguerre (the last two are our proposals). The command logs to run all the experiments can be found here: [Ladder, Laguerre and LMU](https://github.com/CognitiveHorizons/NeuralODE/blob/master/docs/command_log_s1.md), [BRC and nBRC](https://github.com/CognitiveHorizons/NeuralODE/blob/master/docs/command_log_s2.md), and [LSTM and GRU](https://github.com/CognitiveHorizons/NeuralODE/blob/master/docs/command_log_s3.md).

- **Classification** (`class.py`): through this benchmark the NN architecture is faced to a multi-class classification problem on the following datasets: [psMNIST](https://arxiv.org/pdf/1902.06704), [Wafer](http://www.timeseriesclassification.com/description.php?Dataset=Wafer), [PhonemeSpectra](http://www.timeseriesclassification.com/description.php?Dataset=PhonemeSpectra), [PenDigits](http://www.timeseriesclassification.com/description.php?Dataset=PenDigits), and [ChlorineConcentration](http://www.timeseriesclassification.com/description.php?Dataset=ChlorineConcentration).  
```
  python class.py <<model_name>> <<dataset>> <<validation_mode>> <<verbose>>
```

- **System Identification** (`sysid.py`): this experiment consists of learning an input/output (black-box) model for a dynamical system. The training/testing/validation data is generated by integrating the differential equation of the nonlinear `Pendulum` (two states) and a nonlinear `FluidFlow` (three states) subjected to a random input and random initial conditions. Validation can be done either using `k-fold` (number of splits defaults to 5) cross-validation or conventional (mode = `normal`) splitting into training, testing and validation datasets.

```
  python sysid.py <<model_name>> <<dataset>> <<validation_mode>> <<verbose>>
```
- **Time-Series Prediction** (`dyn-pred.py`): in this task, the NN has to predict future samples from time-series data generated from integrating the state equations of a dynamical system (`Pendulum` or `FluidFlow`). For the Pendulum system, it is possible to specify the initial angle to switch between operation in the linear and the nonlinear region. Gaussian noise can be added into the time-domain signals by specifying a level (by default, `noise` = 0.0). The experiments are performed with different seeds (default, `n_seeds = 1`).  The task was adapted from this [reference](https://arxiv.org/pdf/2003.02236.pdf).
```
  python dyn-pred.py <<model_name>> <<experiment>> <<noise>> <<number_of_seeds>> <<initial_condition>>
```

An example to run the time series prediction experiment using the Ladder network on the Pendulum benchmark, with noise level of 0.03, two seeds, and an initial angle condition of 0.8:
```
  python dyn-pred.py LMU Pendulum 0.03 2 0.8
```

Likewise, to run the psMNIST classification with 5-fold cross-validation:
```
  python class.py Ladder psMNIST k-fold verb
```

## Installation

All experiments have been executed using Python 3.7 and TensorFlow < 2. We recommend to use a `conda` environment to reproduce the tests of this repository. The exact requirements have been provided in `requirements.txt` and can be installed by:

```
  pip install -r requirements.txt
```

This requirements were obtained from a setup having a NVIDIA-GPU CUDA capable card (hence `tensorflow-gpu` was installed). If the machine has not a GPU, the following is a list of the dependencies that can be installed via `pip`:

```
  numpy
  pandas
  sklearn
  matplotlib
  nengolib
  tensorflow == 1.15.3
```

For TensorFlow with a GPU card, use `tensorflow-gpu == 1.15.3`.

To install the library `python-control` via conda, do

```
  conda install -c conda-forge control slycot
```

inside an environment.
